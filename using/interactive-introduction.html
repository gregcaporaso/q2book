
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. An interactive introduction to QIIME 2 &#8212; q2book</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Metadata in QIIME 2" href="metadata.html" />
    <link rel="prev" title="2. Getting started with using QIIME 2" href="getting-started.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KZHV37SG3H"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-KZHV37SG3H');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">q2book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../front-matter/preface.html">
   Preface
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Front Matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../front-matter/reading.html">
   1. Reading this book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Microbiome Bioinformatics with QIIME 2
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="getting-started.html">
   2. Getting started with using QIIME 2
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. An interactive introduction to QIIME 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="metadata.html">
   4. Metadata in QIIME 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="importing.html">
   5. Importing data into QIIME 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="demultiplexing.html">
   6. Demultiplexing a sequencing run
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="denoising.html">
   7. Denoising demultiplexed sequencing data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="taxonomy.html">
   8. Taxonomic annotation and analysis of sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="alpha-diversity.html">
   9. Alpha diversity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="beta-diversity.html">
   10. Beta diversity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="feature-table-normalization.html">
   11. Normalization of Feature Tables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Back Matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../back-matter/importing-examples.html">
   12. Appendix: Examples illustrating importing data into QIIME 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../back-matter/advanced-metadata-formatting.html">
   13. Appendix: Advanced metadata formatting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../back-matter/microbiome-methods.html">
   14. Appendix: A brief introduction to methods in microbiome science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../back-matter/q2-origin-story.html">
   15. Appendix: History of the QIIME platform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../back-matter/glossary.html">
   16. Glossary
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/using/interactive-introduction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/using/interactive-introduction.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/gregcaporaso/q2book/main?urlpath=tree/book/using/interactive-introduction.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-study">
   3.1. The study
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downloading-the-data">
   3.2. Downloading the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-summaries-of-sequencing-run-quality-and-demultiplexing">
   3.3. Viewing summaries of sequencing run quality and demultiplexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#denoising-the-demultiplexed-sequences">
   3.4. Denoising the demultiplexed sequences
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-a-summary-of-the-denoising-run">
   3.5. Viewing a summary of the denoising run
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-the-asv-sequences">
   3.6. Viewing the ASV sequences
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-the-asv-table-summary">
   3.7. Viewing the ASV table summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computing-community-richness-at-different-depths-of-sequencing">
   3.8. Computing community richness at different depths of sequencing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wrapping-up">
   3.9. Wrapping up
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#list-of-works-cited">
   3.10. List of works cited
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>An interactive introduction to QIIME 2</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-study">
   3.1. The study
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downloading-the-data">
   3.2. Downloading the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-summaries-of-sequencing-run-quality-and-demultiplexing">
   3.3. Viewing summaries of sequencing run quality and demultiplexing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#denoising-the-demultiplexed-sequences">
   3.4. Denoising the demultiplexed sequences
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-a-summary-of-the-denoising-run">
   3.5. Viewing a summary of the denoising run
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-the-asv-sequences">
   3.6. Viewing the ASV sequences
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-the-asv-table-summary">
   3.7. Viewing the ASV table summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computing-community-richness-at-different-depths-of-sequencing">
   3.8. Computing community richness at different depths of sequencing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wrapping-up">
   3.9. Wrapping up
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#list-of-works-cited">
   3.10. List of works cited
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="an-interactive-introduction-to-qiime-2">
<span id="interactive-introduction"></span><h1><span class="section-number">3. </span>An interactive introduction to QIIME 2<a class="headerlink" href="#an-interactive-introduction-to-qiime-2" title="Permalink to this headline">¶</a></h1>
<p>In the previous chapter I introduced you to some concepts that will help you learn QIIME 2 more quickly. Now that we’re through that, let’s jump in and do something quick with QIIME 2. In this chapter I’ll present a workflow, which you should follow along with on your computer if possible. In this workflow we’ll download some real sequencing data and associated sample metadata, and apply some QIIME 2 methods and visualizers to it to see if it supports a hypothesis about the biological system being studied. The interactive visualizations that we’ll build in this chapter are some of the first ones that I generate when working with a new data set. They will help you to judge the quality of your sequencing run, and give you an initial view of the alpha diversity of your samples. Before you can apply these steps to your own data, you’ll also need to learn how to import your data into a QIIME 2 artifact. This will be covered in <a class="reference internal" href="importing.html#importing"><span class="std std-ref">Importing data into QIIME 2</span></a>.</p>
<div class="section" id="the-study">
<h2><span class="section-number">3.1. </span>The study<a class="headerlink" href="#the-study" title="Permalink to this headline">¶</a></h2>
<p>For the purpose of getting a very quick overview of QIIME 2, we’re going to work with a desert soil microbiome data set that I was involved with generating to study the Atacama Desert in northern Chile <span id="id1">[<a class="reference internal" href="#id10">NCC+17</a>]</span>. The Atacama Desert is one of the most arid locations on the Earth: in many years the hyper-arid core of the desert receives no rain at all. The data we’ll use here is sampled along a gradient from the hyper-arid core of the desert to the western foothills of the Andes mountain range, where there is more moisture resulting from snowmelt in the mountains.</p>
<p>I have a few hypotheses going into this analysis that we can test when we analyze the data. I’m formulating these hypotheses now, before I start analyzing the data, so I have an idea of what I expect to see. After analyzing the samples, I’ll have a good idea of whether the data supports my hypotheses or whether I’m surprised by the results. For the purpose of this introductory analysis I’m going to focus on one hypothesis.</p>
<ul class="simple">
<li><p>Hypothesis: There will be fewer types of microbes in the hyper-arid samples than in the less arid samples.</p></li>
</ul>
<p><strong>Type of microbe</strong> is a term that needs to be defined. What I mean by that is an arbitrary taxonomic grouping, such as genus, species, or strain. The data we’ll work with in this chapter is 16S rRNA amplicon data. To keep the analysis in this chapter simple, we’re not going to assign taxonomy to our amplicon sequences. The unit of taxonomy that we’ll work with here is the highest resolution possible for a study based on amplicon data: the <em>amplicon sequence variant</em>, or ASV. Each unique 16S rRNA amplicon that we observe in this study will be treated as a different ASV, and thus a different “type of microbe”. Due to the limits of resolution in a 16S rRNA amplicon study, this approximates genus or species but does not consistently represent a single named taxonomic level.</p>
</div>
<div class="section" id="downloading-the-data">
<h2><span class="section-number">3.2. </span>Downloading the data<a class="headerlink" href="#downloading-the-data" title="Permalink to this headline">¶</a></h2>
<p>We’ll begin this interactive overview by downloading a few files to work on. Do this as follows:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -sL <span class="se">\</span>
  <span class="s2">&quot;https://data.qiime2.org/2020.11/tutorials/atacama-soils/sample_metadata.tsv&quot;</span> &gt; <span class="se">\</span>
  <span class="s2">&quot;sample-metadata.tsv&quot;</span>

curl -sL <span class="se">\</span>
  <span class="s2">&quot;https://docs.qiime2.org/2020.11/data/tutorials/atacama-soils/demux.qza&quot;</span> &gt; <span class="se">\</span>
  <span class="s2">&quot;demux.qza&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p>You’ll see some output on the screen, and you should ultimately see that these two files were downloaded successfully.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If it seems like the download failed, remove any files that were generated by these commands and try to download them again. If you’re still running into errors, you should feel free to post a question to the <a class="reference external" href="https://forum.qiime2.org">QIIME 2 Forum</a>. In general, if you’re confused about something in the book, or something isn’t working for you, the QIIME 2 Forum is the best place to get help. Start by searching to see if anyone has asked a similar question that has been answered. If not, post your own question. It can be intimidating to post questions to online forums, but it can also be extremely helpful. Don’t worry - the QIIME 2 community is very friendly and many of the people posting questions there had little or no experience using command line software before trying QIIME 2. Even if your question feels hopelessly basic, you can rest assured that someone has had or will have almost the same question you’re asking.</p>
</div>
<p>The two <code class="docutils literal notranslate"><span class="pre">curl</span></code> commands that you just ran each downloaded a file that we’ll use to get started on this analysis. The first, <code class="docutils literal notranslate"><span class="pre">sample-metadata.tsv</span></code>, is a tab-separated text file (the <code class="docutils literal notranslate"><span class="pre">.tsv</span></code> file extension tells you this). In QIIME 2, the sample metadata file maps sample identifiers to information about those samples. You should be able to open and view that file in a program such as Google Sheets (any text editor, such as NotePad, NotePad++, TextEdit, or TextMate, will also work, but the layout that will provided by a spreadsheet viewer will help you interpret the file contents). In this data set you’ll see that sample metadata includes information such as the latitude and longitude where a sample was collected, whether that site was classified as hyper-arid, arid, or semi-arid. As you can imagine, that information is essential for letting us explore the hypotheses that I listed above. Sample metadata is absolutely essential to your analysis, a topic we’ll revisit many times throughout this book.</p>
<p>The second file that we downloaded above is a QIIME 2 artifact containing our demultiplexed sequence data. This is sequencing data that has undergone some processing since it came off an Illumina DNA sequencing instrument. Specifically, the sequences have already been mapped to the samples they were observed in: a process referred to as demultiplexing. You can start a QIIME 2 analysis with data that is demultiplexed, as illustrated here, or data that is multiplexed. We’ll discuss this more in <a class="reference internal" href="demultiplexing.html#demultiplexing"><span class="std std-ref">Demultiplexing a sequencing run</span></a>. In this chapter we’re starting with already demultiplexed data to keep this overview brief.</p>
</div>
<div class="section" id="viewing-summaries-of-sequencing-run-quality-and-demultiplexing">
<h2><span class="section-number">3.3. </span>Viewing summaries of sequencing run quality and demultiplexing<a class="headerlink" href="#viewing-summaries-of-sequencing-run-quality-and-demultiplexing" title="Permalink to this headline">¶</a></h2>
<p>As mentioned in the previous chapter, QIIME 2 artifacts such as the <code class="docutils literal notranslate"><span class="pre">demux.qza</span></code> file that you just downloaded are intermediary files in a QIIME 2 analysis. They’re not meant to be directly viewed by humans. Generally when there is something important to view from a QIIME 2 artifact, such as a summary of the data, there will be a QIIME 2 visualizer that you can apply to that artifact. Some QIIME 2 visualizers are specific to a QIIME 2 artifact type, while others are more general purpose. We’ll look at an example of each in this chapter.</p>
<p>The first QIIME 2 command that we’ll use in this chapter is a visualizer that that is specific to visualizing summaries of demultiplexed sequence data with quality scores. In addition to a summary of the demultiplexing run, it provides information on the quality of sequence data in the form of interactive visualizations. You can run this command as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime demux summarize <span class="se">\</span>
  --i-data demux.qza <span class="se">\</span>
  --o-visualization demux.qzv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved Visualization to: demux.qzv</span>
</pre></div>
</div>
</div>
</div>
<p>Since this is one of the first QIIME 2 commands that you’ve run (at least while reading this book) let’s take a look at it in some detail. As we look at this command, I’m going to assume that you either have some command line software experience.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-video admonition">
<p class="admonition-title">Video</p>
<p><a class="reference external" href="https://youtu.be/vNC-Yi_5Vto">This video</a> provides a review of interacting with a Linux command line. The span of video between about 6:30-8:00 minutes covers details on connecting to a specific server that we set up for a QIIME 2 workshop using the <a class="reference external" href="https://chrome.google.com/webstore/detail/secure-shell-app/pnhechapfaindjhompbnflcldabbghjo?hl=en">Google Chrome Secure Shell App</a>. If you’re connecting to a remote server to access a command line, your connection details will differ from what is presented in that segment of the video.</p>
</div>
</div>
<p>There are four components to notice on the first line of this command, and as is typically the case when running command line software, the command’s components are separated by spaces. The first space-separated component is <code class="docutils literal notranslate"><span class="pre">qiime</span></code>. This tells your computer that the QIIME 2 program should be run. The second space-separated component is <code class="docutils literal notranslate"><span class="pre">demux</span></code>. This is the name of the q2-demux plugin, as far as QIIME 2 is concerned, so this tells QIIME 2 that you want to use the <code class="docutils literal notranslate"><span class="pre">q2-demux</span></code> plugin. The third space-separated component is <code class="docutils literal notranslate"><span class="pre">summarize</span></code>, which is an action in the q2-demux plugin. This action generates a visual summary of demultiplexed sequence data. As mentioned in the previous chapter, if you’d like to learn about this action, you could run the command <code class="docutils literal notranslate"><span class="pre">qiime</span> <span class="pre">demux</span> <span class="pre">summarize</span> <span class="pre">--help</span></code>, which will print help text to the screen. Finally, the <code class="docutils literal notranslate"><span class="pre">\</span></code> at the end of the line is worth mentioning now. When you’re working on the command line, line breaks (i.e., the character that is received when you press the <em>Return</em> key on your keyboard) signifies that you have finished entering the command and that the command should now be executed (i.e., run). Since QIIME 2 commands can sometimes be long, it’s helpful when documenting them to split them over multiple lines so that they can be read without the reader having to scroll to the right. If the documentation is being presented in a non-interactive medium, such as a printed book, the formatting of the command could actually be misleading - for example, it could look like you should press the <em>Return</em> key after entering only part of the command. Splitting long commands across multiple lines also therefore helps to ensure accuracy of the documentation and it improves readability. The <code class="docutils literal notranslate"><span class="pre">\</span></code> character here simply means that the terminal shouldn’t interpret the line break that follows it as the end of the command, but rather that the command will continue on the next line. The same command, without the line breaks, would look like the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime demux summarize --i-data demux.qza  --o-visualization demux.qzv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved Visualization to: demux.qzv</span>
</pre></div>
</div>
</div>
</div>
<p>That command will do the exact same thing as the one above. As our commands get longer later in this chapter and beyond, this would be inconvenient to read.</p>
<p>After we specify the program (<code class="docutils literal notranslate"><span class="pre">qiime</span></code>), the plugin (<code class="docutils literal notranslate"><span class="pre">demux</span></code>), and the action (<code class="docutils literal notranslate"><span class="pre">summarize</span></code>) that we want to run, we provide options to that action to tell it what file(s) we want it to operate on and what we want the output(s) to be called. These components of the command are specified on the remaining lines. Let’s look at those now.</p>
<p>This action takes one QIIME 2 artifact as input, the demultiplexed sequences that we downloaded above. In the QIIME 2 command line interface, input artifacts are always specified with options beginning with <code class="docutils literal notranslate"><span class="pre">--i-</span></code>. This command will generate one file as output, and we specify the path (absolute or relative) where we want to store that file with an output option. Output options always begin with <code class="docutils literal notranslate"><span class="pre">--o-</span></code> in the QIIME 2 command line interface. Here I specify that the output created by this command should be called <code class="docutils literal notranslate"><span class="pre">demux.qzv</span></code>. This is a QIIME 2 visualization that will contain the visual summary of our demultiplexed sequence data.</p>
<p>Finally, notice that this command printed some text to the screen when it was run: <code class="docutils literal notranslate"><span class="pre">Saved</span> <span class="pre">Visualization</span> <span class="pre">to:</span> <span class="pre">demux.qzv</span></code>. This indicates that the command ran and completed successfully. If the command did not complete successfully, you’d see an error message printed to the screen instead.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-video admonition">
<p class="admonition-title">Video</p>
<p><a class="reference external" href="https://t.co/eJbm03cnSa">This video</a> on the QIIME 2 YouTube channel illustrates how to use QIIME 2 View.</p>
</div>
</div>
<p>The next step is viewing this visualization. You can do this in a few ways, but the one I recommend right now is using <a class="reference external" href="https://view.qiime2.org">QIIME 2 View</a>. Open that page in your web browser now. You should see a big box on the screen where you can drop a QIIME 2 artifact or visualization to view it. Load the <code class="docutils literal notranslate"><span class="pre">demux.qzv</span></code> visualization by dragging and dropping it onto that box. A QIIME 2 visualization should load. (**TODO: The user may not know how to locate a file they have generated on the command line. Point to some guidance on this.)</p>
<p>Notice that this visualization has two tabs within the page respectively labeled <em>Overview</em> and <em>Interactive Quality Plot</em>. The <em>Overview</em> tab provides a summary of the sequence counts per sample (i.e., the number of sequences that were obtained for each sample in the sequencing run) (<a class="reference internal" href="#demux-1"><span class="std std-numref">Fig. 3.1</span></a>). Because this is a paired-end sequencing run this is presented for both the forward and reverse reads.</p>
<p>The median sequence per sample count is 7118. This is a bit lower than I typically like to see for a 16S Illumina run. I notice when looking at the details on the bottom of the page though that a lot of samples had very low sequence counts. Scroll down in the visualization on QIIME 2 View to see the number of sequences obtained for each sample. The very low sequences counts (less than a few thousand, though this is subjective) likely indicates an issue with DNA extraction or amplification of those samples.</p>
<div class="figure align-default" id="demux-1">
<img alt="../_images/demux-1.png" src="../_images/demux-1.png" />
<p class="caption"><span class="caption-number">Fig. 3.1 </span><span class="caption-text">Simplified screenshot of <code class="docutils literal notranslate"><span class="pre">demux.qzv</span></code>.</span><a class="headerlink" href="#demux-1" title="Permalink to this image">¶</a></p>
</div>
<p>The second tab in this visualization, <em>Interactive Quality Plot</em>, presents a summary of sequence quality scores (y-axis) by sequence position (x-axis). Open that tab in QIIME 2 View. A box plot is presented at each sequence position, where each box presents five values from <a class="reference external" href="https://en.wikipedia.org/wiki/Seven-number_summary">a seven-number summary</a>. As you hover over the boxes in that plot, the full seven-number summary will populate the table below the plot. The forward read quality plot, and a seven-number summary of the read quality at a single position, are presented in <a class="reference internal" href="#demux-2"><span class="std std-numref">Fig. 3.2</span></a>. This looks like a high quality sequencing run to me.</p>
<div class="figure align-default" id="demux-2">
<img alt="../_images/demux-2.png" src="../_images/demux-2.png" />
<p class="caption"><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Simplified screenshot of plot illustrating sequence quality by sequence position for forward sequencing reads. This plot and other information are presented in the <em>Interactive Quality Plot</em> tab of <code class="docutils literal notranslate"><span class="pre">demux.qzv</span></code>.</span><a class="headerlink" href="#demux-2" title="Permalink to this image">¶</a></p>
</div>
<p>Spend a few minutes exploring this visualization, but don’t worry if you don’t fully understand it right now. We’re going to discuss these plots, as well as demultiplexing in general, in more detail in other chapters. Remember, the goal of this chapter is just to do a few things quickly with QIIME 2.</p>
</div>
<div class="section" id="denoising-the-demultiplexed-sequences">
<h2><span class="section-number">3.4. </span>Denoising the demultiplexed sequences<a class="headerlink" href="#denoising-the-demultiplexed-sequences" title="Permalink to this headline">¶</a></h2>
<p>Since our sequence quality generally looks good, let’s move on to the next step of our analysis: denoising the sequences (i.e., performing sequence quality control). QIIME 2 has a few options for denoising sequences. Here we’ll use the DADA2 denoising approach <span id="id2">[<a class="reference internal" href="#id12">CMR+16</a>]</span>, which we’ll access through the <code class="docutils literal notranslate"><span class="pre">q2-dada2</span></code> plugin. Go ahead and run this command, which may take up to about 10 minutes to complete.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime dada2 denoise-single <span class="se">\</span>
  --i-demultiplexed-seqs demux.qza <span class="se">\</span>
  --p-trim-left <span class="m">13</span> <span class="se">\</span>
  --p-trunc-len <span class="m">150</span> <span class="se">\</span>
  --o-representative-sequences asv-sequences.qza <span class="se">\</span>
  --o-table asv-table.qza <span class="se">\</span>
  --o-denoising-stats denoising-stats.qza
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved FeatureTable[Frequency] to: asv-table.qza</span>
<span class=" -Color -Color-Green">Saved FeatureData[Sequence] to: asv-sequences.qza</span>
<span class=" -Color -Color-Green">Saved SampleData[DADA2Stats] to: denoising-stats.qza</span>
</pre></div>
</div>
</div>
</div>
<p>As you can tell from the first line of this command, we’re calling the program <code class="docutils literal notranslate"><span class="pre">qiime</span></code>, the plugin <code class="docutils literal notranslate"><span class="pre">dada2</span></code>, and the action <code class="docutils literal notranslate"><span class="pre">denoise-single</span></code>. This runs DADA2’s single-end read denoiser, which may seem like a surprising choice given that I previously mentioned that this is paired end data. The reason that I choose to use the single end denoiser here is that these are short sequence reads for the region of the 16S rRNA that we’re sequencing. The region is about 350 bases long, but the sequencing run was a 2x151 run (where the 2 implies that it was paired end, for two reads, and 151 implies that 151 bases were read in each direction). These reads are too short for paired end joining for this region of the 16S, so I’m not going to join them here. (If we were to apply paired end joining with the <code class="docutils literal notranslate"><span class="pre">denoise-paired</span></code> action, the reads that failed to join would be excluded from the results. This would result in a bias for organisms with shorter 16S sequences, which would likely have a confusing impact on our findings.)</p>
<p>You can also see that this command takes a single file as input. This is the same file we provided as input to <code class="docutils literal notranslate"><span class="pre">qiime</span> <span class="pre">demux</span> <span class="pre">summarize</span></code>: our demultiplexed sequence data. This command generates three output artifacts, as specified by the <code class="docutils literal notranslate"><span class="pre">--o-</span></code> options. Recall that the unit of taxonomy that we’re working with in this chapter is the amplicon sequence variant (ASV). When DADA2 denoises a sequencing run, it defines the ASVs that were observed from the quality-controlled sequences. One of the outputs that it generates is the collection of the ASV sequences that were defined. This is one of the three outputs that are generated, and you can specify the filepath where you’d like to store that file with the output option <code class="docutils literal notranslate"><span class="pre">--o-representative-sequences</span></code>. I called that file <code class="docutils literal notranslate"><span class="pre">asv-sequences.qza</span></code>. DADA2 also creates our feature table, and the path where that should be stored is specified with the <code class="docutils literal notranslate"><span class="pre">--o-table</span></code> option. I chose the name <code class="docutils literal notranslate"><span class="pre">asv-table.qza</span></code> for this output file. The feature table is one of the most important piece of data that you’ll generate and use in QIIME 2. While the contents of the feature table can differ depending on the data that you’re working with or the stage of your analysis (something we’ll revisit later), the feature table we created here defines the frequency at which each ASVs is observed in each sample. The feature table contains samples on one axis and ASVs on the other axis, and the values in this table describe how many times each ASV was observed in each sample. The values can be zero or greater in this feature table. The third output generated by this command, specified with <code class="docutils literal notranslate"><span class="pre">--o-denoising-stats</span></code>, is a log of the denoising run that summarizes which quality control steps were taken.</p>
<p>There is also a new option type used here: <code class="docutils literal notranslate"><span class="pre">--p-</span></code>. This is a parameter option, which controls some aspect of how the action runs. In this case, we’re specifying two parameters options, <code class="docutils literal notranslate"><span class="pre">--p-trim-left</span></code> and <code class="docutils literal notranslate"><span class="pre">--p-trunc-len</span></code>. These are parameters used by DADA2 to assist in quality control. <code class="docutils literal notranslate"><span class="pre">--p-trim-left</span></code> specifies a position that all sequences should be “trimmed” at, meaning that all bases before this position (i.e., toward the 5’ end of the sequence from this position) are removed from all sequences. This is done because the initial reads of a sequence tend to be lower quality. You can see this in <a class="reference internal" href="#demux-2"><span class="std std-numref">Fig. 3.2</span></a>. The <code class="docutils literal notranslate"><span class="pre">--p-trunc-len</span></code> works similarly, but truncates the sequences at the specified position (i.e., all bases that are 3’ of the specified position are removed). In the <a class="reference internal" href="#demux-2"><span class="std std-numref">Fig. 3.2</span></a> you can see that the median quality is lower than average before position 13 and after position 150 so I chose these values for trimming and truncating sequences in this data set. These are values that you’ll choose for each sequencing data set that you’re working with, and we’ll discuss choosing values for these parameters in <a class="reference internal" href="denoising.html#denoising"><span class="std std-ref">Denoising demultiplexed sequencing data</span></a>.</p>
<p>Your <code class="docutils literal notranslate"><span class="pre">denoise-single</span></code> command may have finished running by now. If not, take a break for a few minutes. Stretch your legs, go for a walk around the block, or grab a glass of water. Waiting for a long-running job (e.g., the command that is currently running) to finish is a great opportunity to break up your screen time.</p>
<div class="figure align-default" id="xkcd-compiling">
<a class="reference internal image-reference" href="https://imgs.xkcd.com/comics/compiling.png"><img alt="https://imgs.xkcd.com/comics/compiling.png" src="https://imgs.xkcd.com/comics/compiling.png" style="height: 250px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.3 </span><span class="caption-text">For programmers, waiting for code to compile is an excuse for a break. For data analysts, it’s waiting for a long-running job to finish.</span><a class="headerlink" href="#xkcd-compiling" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="viewing-a-summary-of-the-denoising-run">
<h2><span class="section-number">3.5. </span>Viewing a summary of the denoising run<a class="headerlink" href="#viewing-a-summary-of-the-denoising-run" title="Permalink to this headline">¶</a></h2>
<p>The next visualizer that we’ll use is a general purpose visualizer that you should always keep in mind. It’s the <code class="docutils literal notranslate"><span class="pre">tabulate</span></code> visualizer in the <code class="docutils literal notranslate"><span class="pre">q2-metadata</span></code> plugin. This command uses the final option that the QIIME 2 command line interface uses: <code class="docutils literal notranslate"><span class="pre">--m-</span></code>, which specifies a metadata-related input. This might not seem very intuitive at the moment, but many QIIME 2 artifacts that provide some information on a per-sample basis can be used as if they are sample metadata. The power of this will become more clear in later chapters. We’ll apply this to the log artifact that was generated by <code class="docutils literal notranslate"><span class="pre">denoise-single</span></code> as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime metadata tabulate <span class="se">\</span>
  --m-input-file denoising-stats.qza <span class="se">\</span>
  --o-visualization denoising-stats.qzv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved Visualization to: denoising-stats.qzv</span>
</pre></div>
</div>
</div>
</div>
<p>Load the resulting <code class="docutils literal notranslate"><span class="pre">.qzv</span></code> file with <a class="reference external" href="https://view.qiime2.org">QIIME 2 View</a>. You should see something that looks like <a class="reference internal" href="#denoising-stats-1"><span class="std std-numref">Fig. 3.4</span></a>. This table presents the results of the denoising run on a per-sample basis. The <em>input</em> column of the table presents the number of sequence reads that were contained in the <code class="docutils literal notranslate"><span class="pre">demux.qza</span></code> for each sample. Other columns present information such as the percentage of input reads that passed the different quality filtering steps. We’ll revisit log file this in <a class="reference internal" href="denoising.html#denoising"><span class="std std-ref">Denoising demultiplexed sequencing data</span></a>.</p>
<div class="figure align-default" id="denoising-stats-1">
<img alt="../_images/denoising-stats-1.png" src="../_images/denoising-stats-1.png" />
<p class="caption"><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Simplified screenshot of <code class="docutils literal notranslate"><span class="pre">denoising-stats.qzv</span></code>.</span><a class="headerlink" href="#denoising-stats-1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="viewing-the-asv-sequences">
<h2><span class="section-number">3.6. </span>Viewing the ASV sequences<a class="headerlink" href="#viewing-the-asv-sequences" title="Permalink to this headline">¶</a></h2>
<p>Recall that one of the outputs from DADA2 is the ASV sequences. We called this file <code class="docutils literal notranslate"><span class="pre">asv-sequences.qza</span></code> in this example. These sequences may be something that you want to look at, either now (maybe as a sanity check) or at a later stage of the analysis (for example, if you want to learn more about some ASVs that you have become interested in while analyzing your data). The <code class="docutils literal notranslate"><span class="pre">q2-feature-table</span></code> plugin defines a special purpose visualizer for generating a human-readable list of the ASVs. You can apply this as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime feature-table tabulate-seqs <span class="se">\</span>
  --i-data asv-sequences.qza <span class="se">\</span>
  --o-visualization asv-sequences.qzv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved Visualization to: asv-sequences.qzv</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because ASVs are only one of a few types of microbiome features that QIIME 2 can work with, visualizations such as this refer to ASVs as “features”. Other feature types that QIIME 2 can work with are taxa (e.g., features can be microbial genera), functional gene categories (e.g., from a shotgun sequencing run), or metabolites (e.g., in a metabolomics analysis).</p>
</div>
</div>
<p>Load the <code class="docutils literal notranslate"><span class="pre">asv-sequences.qzv</span></code> file with QIIME 2 View. This visualization initially presents a summary of sequence lengths (these are typically the same for single-end Illumina runs, so there is no variance in the sequence lengths with this data). Below this, there is a table presenting ASV identifiers, ASV sequence lengths, and the ASV sequences themselves. The ASV identifiers presented here are used internally by QIIME 2 and are not inherently meaningful. If you are ever presented with an ASV identifier and need to know what sequence it corresponds to, this table will provide you with that information. The sequences presented for each ASV are links that will let you quickly identify a sequence using NCBI BLAST. This is useful for rapidly getting information about a sequence, but using QIIME’s built-in taxonomic classifiers will yield more reliable and informative taxonomic information about sequences. We’ll revisit that in <a class="reference internal" href="taxonomy.html#taxonomy"><span class="std std-ref">Taxonomic annotation and analysis of sequences</span></a>.</p>
<div class="figure align-default" id="asv-sequences-1">
<img alt="../_images/asv-sequences-1.png" src="../_images/asv-sequences-1.png" />
<p class="caption"><span class="caption-number">Fig. 3.5 </span><span class="caption-text">Simplified screenshot of <code class="docutils literal notranslate"><span class="pre">asv-sequences.qzv</span></code>.</span><a class="headerlink" href="#asv-sequences-1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="viewing-the-asv-table-summary">
<h2><span class="section-number">3.7. </span>Viewing the ASV table summary<a class="headerlink" href="#viewing-the-asv-table-summary" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, the feature table defined by DADA2 contains samples on one axis and ASVs on the other axis. The values in this table describe how many times each ASV was observed in each sample. The <code class="docutils literal notranslate"><span class="pre">q2-feature-table</span></code> plugin defines another special purpose visualizer to allow you to get a summary of this information. This can be run as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime feature-table summarize <span class="se">\</span>
  --i-table asv-table.qza <span class="se">\</span>
  --m-sample-metadata-file sample-metadata.tsv <span class="se">\</span>
  --o-visualization asv-table.qzv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved Visualization to: asv-table.qzv</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You may have noticed my convention of naming visual summaries of data the same as the data being summarized, changing only the file extension from <code class="docutils literal notranslate"><span class="pre">.qza</span></code> to <code class="docutils literal notranslate"><span class="pre">.qzv</span></code>. For example, I named the visual summary of <code class="docutils literal notranslate"><span class="pre">asv-sequences.qza</span></code> as <code class="docutils literal notranslate"><span class="pre">asv-sequences.qzv</span></code>, and the visual summary of <code class="docutils literal notranslate"><span class="pre">asv-table.qza</span></code> as <code class="docutils literal notranslate"><span class="pre">asv-table.qzv</span></code>. This is not required - you could name the visual summaries almost anything. I find naming files in this way helps me to keep organized.</p>
</div>
</div>
<p>The first input that I provided is <code class="docutils literal notranslate"><span class="pre">asv-table.qza</span></code>, the feature table.  The next input is our sample metadata, which we provided using a <code class="docutils literal notranslate"><span class="pre">--m-</span></code> option type. The final option tells QIIME 2 where to store the resulting visualization. Open that visualization with <a class="reference external" href="https://view.qiime2.org">QIIME 2 View</a>. You should see a view that looks like <a class="reference internal" href="#asv-table-1"><span class="std std-numref">Fig. 3.6</span></a>. Initially this tells you how many samples are represented in your feature table, how many features (which in this example are ASVs), and the total frequency (which in this example is the number of sequences observed across all samples, or the sum of all values in the feature table). Below this is a summary of the frequency (or number of sequences obtained) per sample in this table.  This value is lower than the value we saw in the demultiplexed sequences summary (<a class="reference internal" href="#demux-1"><span class="std std-numref">Fig. 3.1</span></a>) - that’s because this is the median number of sequences per sample <em>following</em> quality control with DADA2, where the previous value presented the median before quality control with DADA2.</p>
<div class="figure align-default" id="asv-table-1">
<img alt="../_images/asv-table-1.png" src="../_images/asv-table-1.png" />
<p class="caption"><span class="caption-number">Fig. 3.6 </span><span class="caption-text">Simplified screenshot of <em>Overview</em> tab of <code class="docutils literal notranslate"><span class="pre">asv-table.qzv</span></code>.</span><a class="headerlink" href="#asv-table-1" title="Permalink to this image">¶</a></p>
</div>
<p>To explore the frequency per sample in more detail, switch to the <em>Interactive Sample Detail</em> tab in the visualization. This allows you to group samples by metadata and observe any differences that might arise across metadata categories. Under the <em>Plot controls</em> section of the visualization, select <em>vegetation</em> from the <em>Metadata Category</em> dropdown box. Then, move the <em>Sampling Depth</em> slider to somewhere around 100. Your visualization should look something like <a class="reference internal" href="#asv-table-2"><span class="std std-numref">Fig. 3.7</span></a> after this.</p>
<div class="figure align-default" id="asv-table-2">
<img alt="../_images/asv-table-2.png" src="../_images/asv-table-2.png" />
<p class="caption"><span class="caption-number">Fig. 3.7 </span><span class="caption-text">Simplified screenshot of <em>Interactive Sample Detail</em> tab of <code class="docutils literal notranslate"><span class="pre">asv-table.qzv</span></code>.</span><a class="headerlink" href="#asv-table-2" title="Permalink to this image">¶</a></p>
</div>
<p>The barplot on the left now tells you how many samples in each metadata group have at least 100 (or whatever value your slider landed on) sequences. In this case, all of the samples with less than 100 sequences came from sites with no vegetation. These sites are in the hyper-arid core of the desert, and I suspect the reason we obtained so few sequences for these samples is because the microbial biomass is so low that the microbes often fall below the limits of our detection with the Earth Microbiome Project protocol. Remember that this is a <em>very</em> extreme environment - it’s not very surprising to me that the 16S rRNA protocols that we use for the majority of sites on the Earth are challenged here. Importantly though, this hasn’t impacted all of the sites without vegetation so we can still compare these sites to the vegetated sites that are outside of the hyper-arid core of the desert. We’ll now begin to wrap this quick overview up with a comparison of the community richness at the vegetated versus not vegetated sites.</p>
</div>
<div class="section" id="computing-community-richness-at-different-depths-of-sequencing">
<h2><span class="section-number">3.8. </span>Computing community richness at different depths of sequencing<a class="headerlink" href="#computing-community-richness-at-different-depths-of-sequencing" title="Permalink to this headline">¶</a></h2>
<p>Next we’ll generate an alpha rarefaction plot which presents community richness as a function of the number of sequences obtained per sample.</p>
<p>Community richness can be computed with many different metrics. The <code class="docutils literal notranslate"><span class="pre">alpha-rarefaction</span></code> visualizer in the <code class="docutils literal notranslate"><span class="pre">q2-diversity</span></code> plugin defaults to compute Observed Features and the Shannon Diversity Index (the details of these and other diversity metrics will be introduced in later chapters - in both cases, higher values means more diverse communities). You can see these and other default settings for this visualizer by calling <code class="docutils literal notranslate"><span class="pre">qiime</span> <span class="pre">diversity</span> <span class="pre">alpha-rarefaction</span> <span class="pre">--help</span></code>.</p>
<p>It is important to compute community richness as a function of the number of sequences obtained per sample because in a microbiome survey this represents our sampling effort. An analogy is useful to illustrate this. Imagine a researcher is interested in comparing plant diversity in the <a class="reference external" href="https://en.wikipedia.org/wiki/Sonoran_Desert">Sonoran Desert (USA)</a> and the <a class="reference external" href="https://en.wikipedia.org/wiki/Monteverde_Cloud_Forest_Reserve">Monte Verde Cloud Forest (Costa Rica)</a>. If they were to attempt to achieve this by counting plant species in a square meter in the forest and a square kilometer in the desert, they might come to the flawed conclusion that the desert had more types of plants than the forest. This would of course be because they expended more effort sampling plants in the desert than in the forest, so had more opportunity to observe different types of plants. In a sequencing survey, the number of sequences obtained per sample often doesn’t reflect biological features of the environments being studied, but rather random artifacts of the DNA extraction, PCR, and sequencing workflows. Differences in depth of sequencing therefore similarly represent sampling effort. (An exception to this is in extreme cases, such as the hyper-arid desert samples in this study where there are sometimes too few microbes to detect with standard workflows.) Differences in depth of sequencing need to be controlled for across samples to enable direct comparison. There are a variety of ways to do this that will be covered in later chapters. The simplest approach is referred to as <strong>rarefaction</strong>, and involves defining a sequencing depth and randomly sampling the counts in all samples without replacement to that depth. If a sample has fewer sequences than the defined depth of sequencing, that sample is excluded from the analysis at that depth of sequencing. In a rarefaction plot, multiple depths of sequencing are compared along the x-axis to illustrate change in richness on the y-axis. In the <code class="docutils literal notranslate"><span class="pre">alpha-rarefaction</span></code> visualizer, the minimum depth of sequencing used defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>. When calling the command, the user specifies the maximum rarefaction depth. I usually choose a round number near the 3rd quartile frequency per sample from the feature table visual summary (<a class="reference internal" href="#asv-table-1"><span class="std std-numref">Fig. 3.6</span></a>). Run this command as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime diversity alpha-rarefaction <span class="se">\</span>
  --i-table asv-table.qza <span class="se">\</span>
  --p-max-depth <span class="m">2700</span> <span class="se">\</span>
  --m-metadata-file sample-metadata.tsv <span class="se">\</span>
  --o-visualization alpha-rarefaction.qzv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved Visualization to: alpha-rarefaction.qzv</span>
</pre></div>
</div>
</div>
</div>
<p>Within the interactive visualization, samples can be grouped into metadata categories to facilitate visual comparisons. In the sample metadata column select <em>vegetation</em> to group samples based on whether they are observed in sites containing or not containing vegetation. You should see a view that looks something like <a class="reference internal" href="#alpha-rarefaction-1"><span class="std std-numref">Fig. 3.8</span></a>.</p>
<div class="figure align-default" id="alpha-rarefaction-1">
<img alt="../_images/alpha-rarefaction-1.png" src="../_images/alpha-rarefaction-1.png" />
<p class="caption"><span class="caption-number">Fig. 3.8 </span><span class="caption-text">Simplified screenshot of <code class="docutils literal notranslate"><span class="pre">alpha-rarefaction.qzv</span></code>.</span><a class="headerlink" href="#alpha-rarefaction-1" title="Permalink to this image">¶</a></p>
</div>
<p>Note that there are two plots here. The top plot shows the Observed Features metric as a function of Sequence Depth. This is the alpha rarefaction plot. The bottom plot is essential to interpreting the alpha rarefaction plot. This shows the number of samples in each group as a function of sequencing depth. Recall that at a given sequencing depth, if the sequence count is less than the specified sequencing depth the sample is excluded from analyses at that sequencing depth. The bottom plot illustrates that at higher sequencing depths we lose many of our samples. This may explain erratic behavior in the two plots at higher sequence depths (where the Observed Features starts to decrease for the unvegetated sites and starts to increase for the vegetated sites). The bottom plot thus suggests where we should focus our attention in the top plot.</p>
<p>When I compare the Observed Features across the unvegetated and vegetated sites at about 1000-4000 sequences per sample, I see that there appears to be a clear difference in the number of features observed, with the unvegetated sites having a lower community richness than the vegetated sites. This appears to support the hypothesis that was stated in the beginning of this chapter.</p>
<p>I can conclude this analysis by running a statistical test to compare these sites. One catch with a statistical test is that, due to current limitations in the available tests, this is typically performed at a single depth of sequencing. Based on the rarefaction plot, I will perform a statistical comparison of community richness across groups at a sequencing depth of 1200. This is because I have retained most of my samples at this stage, and because the difference in community richness appears stable in that region of the rarefaction plot.</p>
<p>Three commands are required to run this statistical test. Run these commands now.</p>
<p>The first rarefies the ASV table to contain exactly 1200 sequences per sample, and discards samples that had fewer than 1200 sequences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime feature-table rarefy <span class="se">\</span>
  --i-table asv-table.qza <span class="se">\</span>
  --p-sampling-depth <span class="m">1200</span> <span class="se">\</span>
  --o-rarefied-table asv-table-1200.qza
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved FeatureTable[Frequency] to: asv-table-1200.qza</span>
</pre></div>
</div>
</div>
</div>
<p>The next command computes the <em>Observed Features</em> metric on all samples in the rarefied feature table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime diversity alpha <span class="se">\</span>
  --i-table asv-table-1200.qza <span class="se">\</span>
  --p-metric observed_features <span class="se">\</span>
  --o-alpha-diversity observed-features-1200.qza
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved SampleData[AlphaDiversity] to: observed-features-1200.qza</span>
</pre></div>
</div>
</div>
</div>
<p>The third command performs a Kruskal-Wallis test on the <em>Observed Features</em> values and generates a visual summary of the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qiime diversity alpha-group-significance <span class="se">\</span>
  --i-alpha-diversity observed-features-1200.qza <span class="se">\</span>
  --m-metadata-file sample-metadata.tsv <span class="se">\</span>
  --o-visualization observed-features-1200.qzv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Saved Visualization to: observed-features-1200.qzv</span>
</pre></div>
</div>
</div>
</div>
<p>As is always the case, you can call any of these commands with the <code class="docutils literal notranslate"><span class="pre">--help</span></code> option to learn more about what they do, what default values they use, and how you can change their behavior. Load <code class="docutils literal notranslate"><span class="pre">observed-features-1200.qzv</span></code> with QIIME 2 View.</p>
<p>In the resulting visualization, select <em>vegetation</em> in the <em>Column</em> dropdown box. This will present the <em>Observed Features</em> in the unvegetated versus vegetated sites with a pair of boxplots and a statistical test. Your view should look like <a class="reference internal" href="#observed-features-1200-1"><span class="std std-numref">Fig. 3.9</span></a>.</p>
<div class="figure align-default" id="observed-features-1200-1">
<img alt="../_images/observed-features-1200-1.png" src="../_images/observed-features-1200-1.png" />
<p class="caption"><span class="caption-number">Fig. 3.9 </span><span class="caption-text">Simplified screenshot of <code class="docutils literal notranslate"><span class="pre">observed-features-1200.qzv</span></code>.</span><a class="headerlink" href="#observed-features-1200-1" title="Permalink to this image">¶</a></p>
</div>
<p>This view confirms what we suspected from our visual comparison of these categories in the alpha rarefaction plot. Based on a Kruskal-Wallis test (a non-parametric test for comparing distributions of values) and the accompanying boxplot we can conclude that the unvegetated site have significantly fewer ASVs than the vegetated sites, supporting the hypothesis presented at the beginning of this chapter.</p>
</div>
<div class="section" id="wrapping-up">
<h2><span class="section-number">3.9. </span>Wrapping up<a class="headerlink" href="#wrapping-up" title="Permalink to this headline">¶</a></h2>
<p>I’ll conclude this initial QIIME 2 exercise here. In this chapter you downloaded sequencing data, performed quality filtering with QIIME 2, and generated several visual summaries of the data. This introduced you to the QIIME 2 command line interface. You performed both qualitative and quantitative assessments of the hypothesis presented in the beginning of the chapter, and learned to view those results using QIIME 2 View. A lot of ground was covered in this chapter! We’ll now begin to explore the steps in QIIME 2 workflows in more detail, and fill in some of the gaps that we left in this introductory chapter.</p>
</div>
<div class="section" id="list-of-works-cited">
<h2><span class="section-number">3.10. </span>List of works cited<a class="headerlink" href="#list-of-works-cited" title="Permalink to this headline">¶</a></h2>
<p id="id3"><dl class="citation">
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id2">CMR+16</a></span></dt>
<dd><p>Benjamin J Callahan, Paul J McMurdie, Michael J Rosen, Andrew W Han, Amy Jo A Johnson, and Susan P Holmes. DADA2: high-resolution sample inference from illumina amplicon data. <em>Nat. Methods</em>, May 2016.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id1">NCC+17</a></span></dt>
<dd><p>Julia W Neilson, Katy Califf, Cesar Cardona, Audrey Copeland, Will van Treuren, Karen L Josephson, Rob Knight, Jack A Gilbert, Jay Quade, J Gregory Caporaso, and Raina M Maier. Significant impacts of increasing aridity on the arid soil microbiome. <em>mSystems</em>, May 2017.</p>
</dd>
</dl>
</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "calysto_bash"
        },
        kernelOptions: {
            kernelName: "calysto_bash",
            path: "./using"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'calysto_bash'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="getting-started.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2. </span>Getting started with using QIIME 2</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="metadata.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Metadata in QIIME 2</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By J Gregory Caporaso<br/>
    
        &copy; Copyright 2020-2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>